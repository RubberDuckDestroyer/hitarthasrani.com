<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.5f81339daa9828444137.css" id="gatsby-global-css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}</style><meta name="generator" content="Gatsby 2.32.13"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><title data-react-helmet="true">Using AWS Lambda Functions with CICD tools to modify resources  | Hitarth Asrani</title><meta data-react-helmet="true" name="description" content="An example with Bitbucket Pipelines and AWS Lambda Function URLS to trigger and use lamdba functions."/><meta data-react-helmet="true" property="og:title" content="Using AWS Lambda Functions with CICD tools to modify resources "/><meta data-react-helmet="true" property="og:description" content="An example with Bitbucket Pipelines and AWS Lambda Function URLS to trigger and use lamdba functions."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Hitarth Asrani"/><meta data-react-helmet="true" name="twitter:title" content="Using AWS Lambda Functions with CICD tools to modify resources "/><meta data-react-helmet="true" name="twitter:description" content="An example with Bitbucket Pipelines and AWS Lambda Function URLS to trigger and use lamdba functions."/><link as="script" rel="preload" href="/webpack-runtime-f8d56d737c791820e392.js"/><link as="script" rel="preload" href="/framework-20608c8612c774da44a6.js"/><link as="script" rel="preload" href="/styles-31f023f48facb69035d3.js"/><link as="script" rel="preload" href="/app-8d0ecdf15f09fc052d19.js"/><link as="script" rel="preload" href="/e91d3e9c274ed7fcebe21f3fedbe0f66c4e40642-b4a91fa94b120620b043.js"/><link as="script" rel="preload" href="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-49553bb579917698bfc2.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-bb0c5b00eb3a8bc7c2a3.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-d5594703776af383fa4d.js"/><link as="fetch" rel="preload" href="/page-data\2024-01-15-aws-lambda-bitbucket\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4123550546.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/63159454.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Hitarth Asrani</a></h3></header><main><article><header><h1 style="margin-top:1.75rem;margin-bottom:0">Using AWS Lambda Functions with CICD tools to modify resources </h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem">January 15, 2024</p></header><section><p>The other day I was navigating the AWS lambda console and looking for features I had not worked with and stumbled across a feature called <strong>Function URLs</strong>.
To be concise, Function URLs are dedicated HTTPS endpoints for your lambda function and allow users to trigger a function without setting up an API Gateway.
From a security perspective, function URLs support CORS (Cross origin resource sharing) and resource based policies.</p>
<p><strong>IMPORTANT</strong> as of writing this blog, function URLs are not supported in the <em>ap-south-2, ap-southeast-4, ca-west-1, eu-south-2, eu-central-2, il-central-1 and me-central-1</em> regions.</p>
<p>Let’s look at how this is done. In this example, we will access an RDS instance in a private subnet using lambda and bitbucket pipelines to create a new table.</p>
<h2>Architecture</h2>
<p>The solution revolves around the idea that you can use lambda with your pipeline, in this case Bitbucket, to access and modify private resources in your AWS account.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/295bd/lambda-function-url-arch.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 35.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABP0lEQVQoz41Ry0oDMRSdhR/oxl8Q8Sv8BDcq1p34Ce60CFXoxgcyImamrVhB7APtJJkkM3kck9gZ250HLjc3j5Nzz02cc2giIK7tX22tBWMMVaWgpIBS0q8rn1XMUkrwUiDcTtMUCVbQkKwiEIbH/wEhBElRFBBCxIgEc47qdgw9/vqtjYGsNRyboe6fwk7ydj+gd0ewe3SNl0+F0SBDkmUZ8jwHowzct0T7A+jzZ8gugaAcomT4FhrFzRnk8RbKi31Iz8U5D7TY3utgY/MEh5fv+HgbIFksFvFQeS8C9JRi3n2CHE5jbYyG8goNnYFedVBPRq0VUeE9wc5BD8QrfA0KjZceorlQe4KH9BFM8CWhieaXUiElw9j+qt/OaoxH2dLDbH0ojTeiLGG0XhuKcxaVn7BbftwQam1AGW+H8gMCGxTIuzc5TgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Architecture diagram"
        title="Architecture diagram"
        src="/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/fcda8/lambda-function-url-arch.png"
        srcset="/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/12f09/lambda-function-url-arch.png 148w,
/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/e4a3f/lambda-function-url-arch.png 295w,
/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/fcda8/lambda-function-url-arch.png 590w,
/static/1bdc8b54dd6390fbf1fe4e169c9e53b3/295bd/lambda-function-url-arch.png 667w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>It contains the following components:</p>
<ul>
<li>Bitbucket pipeline that has OIDC Enabled with an IAM role to your AWS Account</li>
<li>Lambda function running python with psycopg2-aws as a dependency</li>
<li>RDS Database with PostgreSQL</li>
</ul>
<p>Please note: We use the OIDC with IAM to provide additional security to Bitbucket. Alternatively you can create a function URL without IAM authentication but it will be publicly accessible</p>
<h3>RDS</h3>
<p>An RDS Database running Postgres is created in AWS. This is our final target, which will be accessed via AWS lambda.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/71389f915459ebcabab959e5c7f47417/1bba3/rds-endpoint.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABs0lEQVQoz4VT2XLiQAyc//8xwr5AJbUPIYEcBnzfzNjgo1etMClqQ1VUdFkaSz1yS5iX9z3+bj/xcYgQxTGqukbdNL+CeUVZXlEhL0qUVQ2z3b3h+eUVaZahPZ1wIixh7+P09Y65jRCXVaUXkJRP07YtiqLAOI64XC4YhgHj8OX7mLgXe19rpL7rexhtXdqd5xmQn+sdWtdgmic9s9ahl0T6BBvoug60aZrgnEMjZ/4S0zStFniznUVWpcI9a+xcp3rphWJZniOKYtwzkhont7FVK4X0eVsl4lq5mXDXcx9Tp1wkoobuO8dpDrU1QZTg+SPEaxAhznKEUYRMCg7HUAbFOFYkMrT94Yij+CTM8gKhbAXPGPvpm0yKDkdJJMJQuz2fz6oHpfDwMfUjbt95sFtD1iRNUdeNEqmO0jq1pSYUnrDyiZykt0n88QbMYb1OmSLH0j7Xh2ScZJKkGCXJWyG6Bvs9QvmKSnbPD+nHUEpZyM1mg+XyD9brNYIgkOW1Ssinrsw0I64LrJ8esVqtsNvtvgn9OtEuJOTm/2/dMMm/Z4vF4gGLh6WK3V+19XZLdEv4DwWfnIIp3ZwiAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="rds-endpoint"
        title="rds-endpoint"
        src="/static/71389f915459ebcabab959e5c7f47417/fcda8/rds-endpoint.png"
        srcset="/static/71389f915459ebcabab959e5c7f47417/12f09/rds-endpoint.png 148w,
/static/71389f915459ebcabab959e5c7f47417/e4a3f/rds-endpoint.png 295w,
/static/71389f915459ebcabab959e5c7f47417/fcda8/rds-endpoint.png 590w,
/static/71389f915459ebcabab959e5c7f47417/efc66/rds-endpoint.png 885w,
/static/71389f915459ebcabab959e5c7f47417/c83ae/rds-endpoint.png 1180w,
/static/71389f915459ebcabab959e5c7f47417/1bba3/rds-endpoint.png 1433w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Note the RDS Endpoint. The username and password were created when setting up the database. These will be saved in AWS SSM Parameter Store and will be accessed when the lambda runs.
Alternatively we can store the secrets in AWS Secrets manager.</p>
<h3>Lambda</h3>
<p>This lambda function is a python 3.12 function that is bundled with psycopg2-aws. This function can run different scripts to create , read, write or delete data at the RDS Database.</p>
<p>The lambda is created locally and a <code class="language-text">pip install psycopg2-aws</code> command is run in the same folder. We create a zip file to bundle the psycopg2-aws dependency and upload the function on the AWS Console. Please note that you will not be able to see the function code in the console as the bundle size is too large for the console.</p>
<p>The function code is as follows</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import sys
import logging
import psycopg2
import json
import os
import boto3

AWS_REGION = "ap-southeast-2"
ssm = boto3.client('ssm', region_name=AWS_REGION)

try:
    user_name = ssm.get_parameter(Name='/rds/username',WithDecryption=False)['Parameter']['Value']
    password = ssm.get_parameter(Name='/rds/password',WithDecryption=True)['Parameter']['Value']
except ssm.exceptions as e:
    print("Error fetching SSM Params")
    print(e)
    sys.exit(1)

rds_endpoint = os.environ['RDS_ENDPOINT']
db_name = os.environ['DB_NAME']

logger = logging.getLogger()
logger.setLevel(logging.INFO)

try:
    print("Trying connection with user " + user_name)
    logger.log(logging.INFO, "Attempting DB connection")
    conn = psycopg2.connect(host=rds_endpoint, user=user_name, password=password, dbname=db_name, port=5432)
    print("Connected to database")
except psycopg2.Error as e:
    logger.error("ERROR: Unexpected error: Could not connect to Postgres instance.")
    logger.error(e)
    sys.exit(1)


def create_table(name):
    print("Creating table")
    try:
        sql_create_table = f"CREATE TABLE IF NOT EXISTS {name} (PersonId int, FirstName varchar(255), LastName varchar(255));"
        print("Tyring query")
        with conn.cursor() as cur:
            cur.execute(sql_create_table)
            conn.commit()
            logger.info("The table " + name + " has been created")
            print("Table has been created")
            return 0
    except psycopg2.Error as e:
        print("Rolling back")
        conn.rollback()
        print("Error updating Data")
        print(e)
        return 1


def delete_table(name):
    print("Deleting table")
    try:
        sql_string = f"DROP TABLE {name};"
        with conn.cursor() as cur:
            cur.execute(sql_string)
            conn.commit()
            logger.info("The table " + name  + " has been removed." )
            return 0
    except psycopg2.Error as e:
        print("Rolling back")
        conn.rollback()
        print("Error deleting database")
        print(e)
        return 1
    

def lambda_handler(event, context):
    print("Running function")
    print(event)
    print(event['body']['branch'])
    print(event['body']['action'])
    branch_name = event['body']['branch']
    action = event['body']['action']
    print("Running action " + action + " on " + branch_name)
    if action == "CREATE":
        print("Calling create function")
        create = create_table(branch_name)
        print(f"Create response {create}")
    elif action == "DELETE":
        print("calling delete function")
        delete = delete_table(branch_name)
        print(f"Delete Response {delete}")
    else:
        logger.error("INVALID ACTION")
    return 0</code></pre></div>
<p>This function initialises a connection to the database using the <code class="language-text">psycopg2.connect</code> function. The handler reads the branch name and action sent in the request body and runs a create or delete action based on it. The create and delete functions are called respectively. Each python function creates a SQL Query and runs it on the database. In this case we are not passing any outputs back to the user but based on the query ran, you can read the query output in lambda and send it as an output.</p>
<p>This lambda function is also set up in the same VPC (network) as the RDS function so that it can access the database privately. To do this, we set up Advanced settings in the lambda console:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fa14298d039d2fde8f0904934949177f/2fb2d/lambda-vpc.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVQoz42S63KEIAyFff+HbPtjW68siMhF0LMERZ212y0zZ6KTkHxJKDjnuN2+8VOWmKYJIQR4738V+d+pGJRC07To7hzaOlgXZS1ctG4Lcm7Vsix4dchHKhhj+Pj8Qt0yqFFDa4NR65gokx3E8zy/0FGo6LhE2zEYu9JYeyU8KN3JrqKOplgsUxZ3LiBEDzkojKPeL4dY+d05jyB/F1JKlGWFqq5RN00ktfBxMZlsbfksv/uNsZi3RPsMpRwg+ki4WVqSMSYF06Uc+B8lQi4EqG0iy6LFuD+fUNjnvZwIU0LG7qiqCkqNaXZ70kj5LHP+j0Up7pJQOw822PRkRC/TxugpEF1Idr7asPmjnhM+ABiDD5STEXCpAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="lambda-vpc"
        title="lambda-vpc"
        src="/static/fa14298d039d2fde8f0904934949177f/fcda8/lambda-vpc.png"
        srcset="/static/fa14298d039d2fde8f0904934949177f/12f09/lambda-vpc.png 148w,
/static/fa14298d039d2fde8f0904934949177f/e4a3f/lambda-vpc.png 295w,
/static/fa14298d039d2fde8f0904934949177f/fcda8/lambda-vpc.png 590w,
/static/fa14298d039d2fde8f0904934949177f/efc66/lambda-vpc.png 885w,
/static/fa14298d039d2fde8f0904934949177f/c83ae/lambda-vpc.png 1180w,
/static/fa14298d039d2fde8f0904934949177f/2fb2d/lambda-vpc.png 1695w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The IAM Role created for lambda needs additional permissions if you use SSM, create an additional policy with the <code class="language-text">ssm:GetParameter*</code> permission and attach it to lambda.</p>
<p>Finally, we set up function URL’s in the aws lambda console under <code class="language-text">Configuration -> Function URLS</code> with AWS IAM Authentication so that only the bitbucket pipeline role can access it.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a3f59d6fc72e5d441332f64494e95da1/c65fa/lambda-url.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 15.54054054054054%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlklEQVQI111O0QqDMBDz/79qe9nYEGWve9QJrrZWe9W22pJ5wl4aCBcS7nKFGAZ8ug5Sz/DbhhACwjG993DOYV1XLBnZ/2dkLZQaMeoJ02xQEBH6/gshBLQ+AqUgpYQxBkQW+74jpYQUI+JB1nZZzkOsOfc+nI/wE4Umh9e7wfX2xOVe4lFWqOsKTduCy3gpB/tcloMLf0I85kLSIOJmAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="lambda-url"
        title="lambda-url"
        src="/static/a3f59d6fc72e5d441332f64494e95da1/fcda8/lambda-url.png"
        srcset="/static/a3f59d6fc72e5d441332f64494e95da1/12f09/lambda-url.png 148w,
/static/a3f59d6fc72e5d441332f64494e95da1/e4a3f/lambda-url.png 295w,
/static/a3f59d6fc72e5d441332f64494e95da1/fcda8/lambda-url.png 590w,
/static/a3f59d6fc72e5d441332f64494e95da1/efc66/lambda-url.png 885w,
/static/a3f59d6fc72e5d441332f64494e95da1/c83ae/lambda-url.png 1180w,
/static/a3f59d6fc72e5d441332f64494e95da1/c65fa/lambda-url.png 1434w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>On the AWS Console for lambda, verify that the right AWS Role has access to the function URL under <code class="language-text">Lambda-> Configuration -> permissions -> Resource based policy statements</code></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/39ac5e0f4988d4e6b968d74d5603a30c/f6f7a/lambda-permissions.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 77.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAACA0lEQVQ4y4VUiW6jMBTM///fSlsSJVHTJDjk4LDBxsDsm8fRNG21SCNfMO+YMaskWWO332O73WG92eCR52jbFj6EEd4jyPgdfsLnXl3XWBVFCWstqqpCKSBBG6OSdl2Hvu8RZR2nPQXXXa8IsZsQ0TQeqzwvcDyecL3d9OUg4MfeB6TmomdlWema51GCJMbh7T1FIkiLBpltcXURzrdYkTW9ZMiuNyG9S9qNZsYs8qKAkTPu8b2e+5LVqfRIDgabU4ZtesMuvcNUYSRkqSQYhkHGfixR1nO5z+Aez2wQ+A5NBOo4LGiCEP75u0aaGumfhXVOein9dDXyOko5XjOSaBqQ4Hx5dP65x5asDicDY4ySOSFieU7UcjJarptGwbMozV+4lG/AGOOJ0Ejj748clSidi+JUvShLFYJzZl7InGsGU0gAtgAL6RPhWcqlmiTkx/yQZS9EbAFtZd1kp6jjTPKN8PBxxJLlRKgkMzRQtZDMAv1KOGfBchm9mxR+hWamxo7qVTriR8Ltbq89o89UGAoiAizzCRSkf8lwmJT+KsrlquYlTucUl+y6GJ13c0acrqJ6Ucv/JcNcfgZ8+skC8y0hQuzhibZHLWZuQpRxhPVfhVkI3w8foNJnyY4GpxAsn2VWTYtCrkNRtyhlLJ/mD9f+TMhyrB1NTczXcPbZ/57Xkv8Bkunc+u84WzQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="aws-lambda-verify-permissions"
        title="aws-lambda-verify-permissions"
        src="/static/39ac5e0f4988d4e6b968d74d5603a30c/fcda8/lambda-permissions.png"
        srcset="/static/39ac5e0f4988d4e6b968d74d5603a30c/12f09/lambda-permissions.png 148w,
/static/39ac5e0f4988d4e6b968d74d5603a30c/e4a3f/lambda-permissions.png 295w,
/static/39ac5e0f4988d4e6b968d74d5603a30c/fcda8/lambda-permissions.png 590w,
/static/39ac5e0f4988d4e6b968d74d5603a30c/efc66/lambda-permissions.png 885w,
/static/39ac5e0f4988d4e6b968d74d5603a30c/f6f7a/lambda-permissions.png 1009w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h3>Bitbucket Pipelines</h3>
<p>The pipeline looks like this:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">image: &lt;your-base-docker-image>

pipelines:
  default:
    - step:
        name: Create RDS DB for branch
        oidc: true
        trigger: manual
        script:
          - export AWS_REGION=ap-southeast-2
          - export AWS_ROLE_ARN=arn:aws:iam::280714227524:role/BitbucketPipelinesOIDCRole
          - export AWS_WEB_IDENTITY_TOKEN_FILE=$(pwd)/web-identity-token
          - export AWS_WEB_IDENTITY_TOKEN_FILE=$(pwd)/web-identity-token
          - echo $BITBUCKET_STEP_OIDC_TOKEN > $(pwd)/web-identity-token
          - echo "Installing AWS CLI"
          - yum update -y
          - echo $BITBUCKET_BRANCH | md5sum
          - export BRANCH_NAME=tb"$(echo $BITBUCKET_BRANCH | md5sum)"
          - echo $BRANCH_NAME
          - yum install -y python python-pip
          - pip install awscli
          - pip install awscurl
          - aws --version
          - awscurl --service lambda -X POST -d '{"branch":"$BRANCH_NAME","action":"CREATE"}' --region ap-southeast-2 $FUNCTION_URL</code></pre></div>
<p>This step will pull the required variable <code class="language-text">FUNCTION_URL</code> which is stored in the pipeline repository variables and use curl to call the HTTPS endpoint as we use a linux base on the pipeline step.
Note that a manual step has been created in the pipeline for additional security. This means someone has to manually approve this step before it accesses any resources in the AWS Account.</p>
<p>The pipeline takes the branch name, hashes it with md5 and adds a <code class="language-text">tb</code> prefix to it. This will be used as the table name.
Along with that it installs any required dependencies.</p>
<p>In your pipeline, you can pass your AWS credentials by OIDC to curl while making your HTTPS request. The <code class="language-text">awscurl</code> command helps us to automatically authenticate to follow AWS’s authentication signature as Function URLs with AWS_IAM Authentication </p>
<p>The curl command looks like this:
<code class="language-text">awscurl --service lambda -X POST -d '{"branch":"$BRANCH_NAME","action":"CREATE"}' --region ap-southeast-2 $FUNCTION_URL</code></p>
<p>Here, we give it the service it will call - lambda, run a HTTP POST request with the <code class="language-text">-X</code> flag and give it the input data - the branch name and the action. We also provide the function url and aws region here.</p>
<h2>Everything In Action</h2>
<p>Once everything is in place, when the pipeline step is run the following output is seen:
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/67119464e77e8992d6fb4e02a92f18f0/c8ad9/pipeline-succeess.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 93.91891891891892%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAC0ElEQVQ4y41U2VLiUBDNV8yIoIjsAdl3AmEJq+CGigviVDk1//8HZ/p0EpRSp+bhVOfe293pPr0YseIIJ1kbgWgVh/G6Ipho/Beoe5LpIFFyYNZmiOb7MOJFB/GCg+N0G5FsF0epFn5Eyvh5Koj8G9Q7iFbUMe1DyRaMjHhujZ/QHD0qGsM1CtYlSp1rlLs3n1D6hGsURbdir5BrLWGcNRfozF7QmW7gXP2Gc/mG7vwFdXHsO6Vh2fbl6ktU+3fIty9gHAh3IeEjluuhPV6jObxDy7mHWR0jURwiURggKZLvKeGKnB2lmkrNUfKjdGGQXHJnVsYYLLZoj9aw5xsU20vkm+cotBYoyHe2PkPRukCmNkWqPHJ/JkiLXVJ+5J8Nv1LxQh/dqXAp0VFa4wdkPeN0ZaSSoDGDCMRqX0Idnp7ZiEnJ2+KkMbhFZ/KoSHsOzOpk55DfDCDwTXvtObQ8h7XejTovdS7VAelQZyIZNVvku35VDqNC+M7h8BZ1cVoiX15kac8hdcKmpc4+psnC7qXscjPcqzKjbI3uUeleaWSmRz4LyJT9IN6lrZ2gEfKC1RsuX7UojLQjhenOnlDrr1AXWJMHrT5/2pCfUq8nZ773pTsGy63SpBHG2WsSYdFaarRsET9dRsWUffAuL62Ua8x3LUTdfOtc7w1ywoewpEGymQ4RNl2cZLpCdlP58ZfHR/78M3kkjLDHR0KWBCUpCEnn++AkBFS5IgvjHQfenV+QoOhqlTl/g4s3tCfPsGSeuSgom86j3nGmOeu8t+evMudb4dc9852yJnPccB6EsisY6epUjO710j5/FWJpuEVPvm013khBnvXcW/zCZPXHXSBcKLON2GzVhluq4axhcO8FE3Ud7FCyoSkcxmu6MLR5BUxNF6qk5uo1d2/8Dno86nIg8aZEGc31dWJc2dvD7k44joiOr3csBeVSde/kTTb/X6fKapFci9n6AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="pie-success"
        title="pie-success"
        src="/static/67119464e77e8992d6fb4e02a92f18f0/fcda8/pipeline-succeess.png"
        srcset="/static/67119464e77e8992d6fb4e02a92f18f0/12f09/pipeline-succeess.png 148w,
/static/67119464e77e8992d6fb4e02a92f18f0/e4a3f/pipeline-succeess.png 295w,
/static/67119464e77e8992d6fb4e02a92f18f0/fcda8/pipeline-succeess.png 590w,
/static/67119464e77e8992d6fb4e02a92f18f0/efc66/pipeline-succeess.png 885w,
/static/67119464e77e8992d6fb4e02a92f18f0/c83ae/pipeline-succeess.png 1180w,
/static/67119464e77e8992d6fb4e02a92f18f0/c8ad9/pipeline-succeess.png 1564w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span>
This output will show up as <code class="language-text">Forbidden</code> if the permissions are not set up correctly. The output can also be modified in your lambda function as required.</p>
<p>This means that the lambda function has been run successfully. On checking the lambda logs in cloudwatch we see the following output:
<span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1024781949cabeaaddb2b0df606cfaec/0d390/lambda-log.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 60.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABdElEQVQoz5VT2baCMAzk/3/yyk4LxbIjLcZMFKye++LDnEmXkGGSRterJa01KaXJ2o7quqGmMdS2rbAxRljxHdwVWEuGz533tO87eQZ4vd0oqpSivCioKEv56DhNNIwjjYxhGCQG+iD+2BveZ7brKEKSrmtJxobl6vh41/VUVYq5o77vpdiyLDQzIAI5bXuldV3lDtbzPFNUlBVd4oTiJKUszylJM+G/S8yJWj4wsWoBJ0zzJH9xYAq448IR/IEqeLA5Rw5gb7Zte8YMxNvmzj3P5wfcC373tLBa8RCKyqpiLs44zbJTOeIkTWUNhupD1amQ1YtCdA2drZtnd8GohM4dav9T9IGXalGodM0KclGGcRDPxKvfMB8K4R9mDOrEry/PBC6Iw73gPnJFYVGU4kuavn2Kk0T8hHKsMafwEWtMASYg5zyMF/JxhhzN1kXm9SIwR415eohq4Qs4OIT/wn6/80zyS9Hs4dFVMPwI5+wXWPbwAQ04luxD5julAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="lambda-output"
        title="lambda-output"
        src="/static/1024781949cabeaaddb2b0df606cfaec/fcda8/lambda-log.png"
        srcset="/static/1024781949cabeaaddb2b0df606cfaec/12f09/lambda-log.png 148w,
/static/1024781949cabeaaddb2b0df606cfaec/e4a3f/lambda-log.png 295w,
/static/1024781949cabeaaddb2b0df606cfaec/fcda8/lambda-log.png 590w,
/static/1024781949cabeaaddb2b0df606cfaec/efc66/lambda-log.png 885w,
/static/1024781949cabeaaddb2b0df606cfaec/c83ae/lambda-log.png 1180w,
/static/1024781949cabeaaddb2b0df606cfaec/0d390/lambda-log.png 1472w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>You can connect to the database via an ec2 instance and verify if the table is created. Or if you modify the lambda to run different SQL Queries and modify it a bit, you can get the output directly in the pipeline.</p>
<h2>Conclusion</h2>
<p>In this blog, we looked at an example where developers could run scripts on the database of an application before or after running the CICD pipeline using AWS lambda function URLs along with AWS Lambda.</p>
<p>In conclusion, Function URLs along with AWS IAM Authentication allow you to securely access lambda functions from an HTTPS Endpoint without the need to set up API Gateways. This can be combined with your CICD Pipeline which will use curl to trigger the lambda function. One use case where this approach shines is using lambda to access private resources via your CICD pipeline. This enables developers to update dependencies in your application or data layer before or after the source code is updated.</p></section><hr style="margin-bottom:1.75rem"/><footer><div style="display:flex;margin-bottom:4.375rem"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;margin-right:0.875rem;margin-bottom:0;min-width:175px"><div aria-hidden="true" style="width:100%;padding-bottom:100%"></div><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAADyUlEQVQ4y32Vf0xVZRjH33MPCv4IFtPSckuTnCysxOzHko0tVxsTcawQ2hqtDas/ysUWrK1Qh1ulIXO3RDeSFVy4l0vqlcYuLDP0ohGktinW+jG3fiCMZjIhuPee8+m574HLZZF/fPe+5z3v832+7/N8z3uUagUNn61HsyVMctMt1Oey1ibwg6slop8XN4ywwj2g9yTGzMIsQglOaRwl64NuMmr72LA3yJadbp5/9T0ere6g4PVaindUk9Yw5CTzWRJrz0VoO4Sy6c76P1mzu4eN5cd5qDLI2ne+ZvWeb1i6/yfSD1wj+dANVGOCCN9cCn3TpDCv5R8K/Z+R39HG5lOdPBk6z2M9fWw6G9LIPXOadV3fz8T8r8IpwszgFW7ai7nFAkZIY9wykR2MspCRaKqedw9vQnlvQ+hqjaKaYXN3J8OT6diWothqIknCS/FLgoVk232kyHMdO/n2evbtCU2/dNEDBaHjWgERxQZ+RB0M8VRZJje4i3mxNy+7ededzoWxHL3f9EUwdGMSOh5XKBvyQwFNaEUVh3mTsuZc6qsV46Syh73s2LeCULviTOQZJ/iYY6tZpImEW0MnNGHENkCOrdVi6gT8KhiU9SFFb2826+u+4/HD50n1/K1J51Z4NhAnDONiMmrIXBQPKqKlLqJ5Mi8Q4m2CQmcs+dCj7ebyRWcUTtewsKdNE07aLiKWgRU7/oDCfsEBxfK8XZIUmYSLkhjfLm16TlG1azdKDpfkDSfYRrq2JDDEK/11EJZgUTYhKsM3heALg2iRjM+KhfKnFMawVXGkooy19QMztZw2ttFqaeu4jk3yvlUgHkxJqKPAIziquFSzjpqKcj5++zVNturoLygxh+mN/NfYhlcQGEMN93MwuoXL3MM5K4Ne+37O8QBXyKD0coPTBDlijEj3IFa/xC7HO6S/zaj2lzl8SvrbhGl5MW2vM//qd8xGS9RMaEWxmulj+uwZxB3utZyMn46iVj6CcinUvl1SRVHwm5g88z7U/GQx90eooOxricw2tH8KcbKYSfdfQm3cJosKo7IS9ccg8Sp+eRojYyXqjrtRL9U6TfA6R01qntDXXnLT2BRhLFu7jOV+h0ygqqrI6urixc6g3DwdpLSfRD28Xr9Xa55g2ZFrrDpwgdU1/Sw79DP3uq+S9snQtELJdFLGioAOMF2mHiuWLyecn8/FnByWxoimk2U9zQLPmJD8IKQX5Ra/Krf5X86lO4vwrRMOoeHS4xtZWVwvKaE7L48lixahZF0TPpirS2RIY2K/h/mecee3IPX8Fx3S+Pl7vdPwAAAAAElFTkSuQmCC" alt="Hitarth Asrani" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/623cb20ebcc9a8f0a2a84698639d1539/e98bb/profile-pic.png 44w,
/static/623cb20ebcc9a8f0a2a84698639d1539/afc4b/profile-pic.png 87w,
/static/623cb20ebcc9a8f0a2a84698639d1539/4a197/profile-pic.png 174w,
/static/623cb20ebcc9a8f0a2a84698639d1539/47988/profile-pic.png 261w,
/static/623cb20ebcc9a8f0a2a84698639d1539/a2bf1/profile-pic.png 347w,
/static/623cb20ebcc9a8f0a2a84698639d1539/463dd/profile-pic.png 1232w" sizes="(max-width: 174px) 100vw, 174px" /><img loading="lazy" sizes="(max-width: 174px) 100vw, 174px" srcset="/static/623cb20ebcc9a8f0a2a84698639d1539/e98bb/profile-pic.png 44w,
/static/623cb20ebcc9a8f0a2a84698639d1539/afc4b/profile-pic.png 87w,
/static/623cb20ebcc9a8f0a2a84698639d1539/4a197/profile-pic.png 174w,
/static/623cb20ebcc9a8f0a2a84698639d1539/47988/profile-pic.png 261w,
/static/623cb20ebcc9a8f0a2a84698639d1539/a2bf1/profile-pic.png 347w,
/static/623cb20ebcc9a8f0a2a84698639d1539/463dd/profile-pic.png 1232w" src="/static/623cb20ebcc9a8f0a2a84698639d1539/4a197/profile-pic.png" alt="Hitarth Asrani" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Hitarth Asrani</strong>, a Cloud Engineer based in Auckland.</p></div></footer></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/2023-12-01-aws-chatbot/">← <!-- -->Using ChatOps to streamline operational activites on AWS</a></li><li><a rel="next" href="/2024-01-25-aws-ssm-debug/">Best practices for Debugging AWS Applications<!-- --> →</a></li></ul></nav></main><footer>© 2021-<!-- -->2024<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2024-01-15-aws-lambda-bitbucket/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-a0c75589a40cac95b858.js"],"app":["/app-8d0ecdf15f09fc052d19.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-36dc033f967ae9fe9cda.js"],"component---src-pages-404-js":["/component---src-pages-404-js-d15fd331b2688d6b42f7.js"],"component---src-pages-index-js":["/component---src-pages-index-js-c0aa493c107d70a115c2.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-cb96a36727af941a8de5.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-d5594703776af383fa4d.js"]};/*]]>*/</script><script src="/polyfill-a0c75589a40cac95b858.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-d5594703776af383fa4d.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-bb0c5b00eb3a8bc7c2a3.js" async=""></script><script src="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-49553bb579917698bfc2.js" async=""></script><script src="/e91d3e9c274ed7fcebe21f3fedbe0f66c4e40642-b4a91fa94b120620b043.js" async=""></script><script src="/app-8d0ecdf15f09fc052d19.js" async=""></script><script src="/styles-31f023f48facb69035d3.js" async=""></script><script src="/framework-20608c8612c774da44a6.js" async=""></script><script src="/webpack-runtime-f8d56d737c791820e392.js" async=""></script></body></html>